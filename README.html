<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>argusclient – A minimal client library for Argus webservice &mdash; Argus Client 0.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Argus Client 0.2.1 documentation" href="index.html" />
    <link rel="prev" title="argusclient Package" href="argusclient.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="argusclient-a-minimal-client-library-for-argus-webservice">
<h1>argusclient &#8211; A minimal client library for Argus webservice<a class="headerlink" href="#argusclient-a-minimal-client-library-for-argus-webservice" title="Permalink to this headline">¶</a></h1>
<p>This is a minimal and thin layer of Python client code on top of the
Argus webservices REST API. Most of the library API is 1:1 with that of
REST API so it serves to be more of a convenience than an abstraction.
This means you still need to be familiar with the underlying REST API to
be effective. For more information on the REST API and data model, refer
to the <a class="reference external" href="https://github.com/SalesforceEng/Argus/wiki">Argus - User
Guide</a>.
Special thanks to <a class="reference external" href="https://github.com/demianbrecht">Demian Brecht</a>
for giving a lot of feedback early and helping to shape the API and the
project.</p>
<p>You can also browse the Python API documentation online at: <a href="#id1"><span class="problematic" id="id2">`https://salesforce.github.io/python-argusclient/`__</span></a></p>
<div class="section" id="a-quick-primer-to-using-argusclient">
<h2>A quick primer to using argusclient<a class="headerlink" href="#a-quick-primer-to-using-argusclient" title="Permalink to this headline">¶</a></h2>
<p>Below you will find functional and self-explanatory code that shows how
to do the following:</p>
<ul class="simple">
<li>Import the relevant pieces from argusclient</li>
<li>Create the main entry point and establish login session</li>
<li>Query for existing namespaces</li>
<li>Create a new namespace</li>
<li>Collect metrics and annotations</li>
<li>Post metrics and annotations</li>
<li>Query for existing dashboards</li>
<li>Update or Create dashboard</li>
<li>Query for existing alerts</li>
<li>Delete alert</li>
<li>Create an alert along with a trigger and a notification</li>
</ul>
<p>In addition, also look at the bundled example named
<code class="docutils literal"><span class="pre">splunk_to_argus.py</span></code> that shows how to extract metrics from Splunk and
push them to Argus.</p>
<div class="section" id="some-package-imports-and-initializations-that-we-use-later">
<h3>Some package imports and initializations that we use later<a class="headerlink" href="#some-package-imports-and-initializations-that-we-use-later" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">calendar</span><span class="o">,</span> <span class="nn">getpass</span><span class="o">,</span> <span class="nn">logging</span><span class="o">,</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">lxml.etree</span>

<span class="kn">from</span> <span class="nn">argusclient</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">argusclient.dashboardtags</span> <span class="k">import</span> <span class="n">DASHBOARD</span><span class="p">,</span> <span class="n">CHART</span><span class="p">,</span> <span class="n">TITLE</span><span class="p">,</span> <span class="n">METRIC</span><span class="p">,</span> <span class="n">FLAGS</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">()</span>
<span class="n">logging</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;requests&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>

<span class="n">endpoint</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8080/argusws&quot;</span>
<span class="n">user</span> <span class="o">=</span> <span class="s2">&quot;hdara&quot;</span>
<span class="n">password</span> <span class="o">=</span> <span class="kc">None</span>

<span class="n">tags</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="s2">&quot;hdara-wsl&quot;</span> <span class="p">}</span>
<span class="n">fields</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user</span> <span class="p">}</span>
<span class="n">curtm</span> <span class="o">=</span> <span class="n">long</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">gmtime</span><span class="p">()))</span><span class="o">*</span><span class="mi">1000</span>
<span class="n">ns_name</span> <span class="o">=</span> <span class="s2">&quot;hdara-ns&quot;</span>
<span class="n">ns_access_addl_users</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;hdara&quot;</span><span class="p">,)</span>
<span class="n">dashboard_name</span> <span class="o">=</span> <span class="s2">&quot;hdara.test.dashboard&quot;</span>
<span class="n">alert_name</span> <span class="o">=</span> <span class="s2">&quot;hdara.test.alert&quot;</span>
<span class="n">scope_name</span> <span class="o">=</span> <span class="s2">&quot;hdara&quot;</span>
<span class="n">metric_name</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
<div class="section" id="login-to-the-service-and-establish-session">
<h3>Login to the service and establish session<a class="headerlink" href="#login-to-the-service-and-establish-session" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">argus</span> <span class="o">=</span> <span class="n">ArgusServiceClient</span><span class="p">(</span><span class="n">user</span><span class="p">,</span>
                           <span class="n">password</span> <span class="ow">or</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s2">&quot;Password: &quot;</span><span class="p">),</span>
                           <span class="n">endpoint</span><span class="o">=</span><span class="n">endpoint</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Logging in&quot;</span><span class="p">)</span>
<span class="n">argus</span><span class="o">.</span><span class="n">login</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="check-if-a-namespace-exists-and-create-one-if-missing">
<h3>Check if a namespace exists and create one if missing<a class="headerlink" href="#check-if-a-namespace-exists-and-create-one-if-missing" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Looking up existing namespace with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ns_name</span><span class="p">)</span>
<span class="n">nss</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">ns</span><span class="o">.</span><span class="n">qualifier</span><span class="p">,</span> <span class="n">ns</span><span class="p">)</span> <span class="k">for</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">argus</span><span class="o">.</span><span class="n">namespaces</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">ns</span> <span class="o">=</span> <span class="n">nss</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">ns_name</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">ns</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating new namespace with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">ns_name</span><span class="p">)</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">namespaces</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Namespace</span><span class="p">(</span><span class="n">ns_name</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-some-random-metrics-against-hdara-ns-hdara-test-and-mark-the-start-and-end-with-annotations">
<h3>Generate some random metrics against hdara-ns:hdara:test and mark the start and end with annotations.<a class="headerlink" href="#generate-some-random-metrics-against-hdara-ns-hdara-test-and-mark-the-start-and-end-with-annotations" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Generating some metric and annotation data for the dashboard&quot;</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">Metric</span><span class="p">(</span><span class="s2">&quot;hdara&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">ns_name</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Warden requires 1 minute gap between successive data points.</span>
    <span class="n">ts</span> <span class="o">=</span> <span class="n">curtm</span><span class="o">-</span><span class="n">t</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">1000</span>
    <span class="n">m</span><span class="o">.</span><span class="n">datapoints</span><span class="p">[</span><span class="n">ts</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">ans</span> <span class="ow">or</span> <span class="n">t</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Annotation</span><span class="p">(</span><span class="s2">&quot;script&quot;</span><span class="p">,</span> <span class="s2">&quot;hdara&quot;</span><span class="p">,</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="s2">&quot;generated&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">event</span><span class="o">=</span><span class="n">ans</span> <span class="ow">and</span> <span class="s2">&quot;start&quot;</span> <span class="ow">or</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">fields</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="send-metrics-and-annotations-to-argus">
<h3>Send metrics and annotations to Argus<a class="headerlink" href="#send-metrics-and-annotations-to-argus" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding metrics data to Argus&quot;</span><span class="p">)</span>
<span class="n">am_resp</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">add</span><span class="p">([</span><span class="n">m</span><span class="p">]);</span>
<span class="k">if</span> <span class="n">am_resp</span><span class="o">.</span><span class="n">error_count</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Errors reported in metric data: errorCount: </span><span class="si">%s</span><span class="s2"> errorMessages: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">am_resp</span><span class="o">.</span><span class="n">error_count</span><span class="p">(),</span> <span class="n">am_resp</span><span class="o">.</span><span class="n">error_messages</span><span class="p">())</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Adding annotation data to Argus&quot;</span><span class="p">)</span>
<span class="n">an_resp</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="k">if</span> <span class="n">an_resp</span><span class="o">.</span><span class="n">error_count</span><span class="p">():</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Errors reported in annotation data: errorCount: </span><span class="si">%s</span><span class="s2"> errorMessages: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">an_resp</span><span class="o">.</span><span class="n">error_count</span><span class="p">(),</span> <span class="n">an_resp</span><span class="o">.</span><span class="n">error_messages</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-dashboard-content">
<h3>Generate dashboard content<a class="headerlink" href="#generate-dashboard-content" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mquery</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">MetricQuery</span><span class="p">(</span><span class="n">scope_name</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">stTimeSpec</span><span class="o">=</span><span class="s2">&quot;-1d&quot;</span><span class="p">,</span> <span class="n">enTimeSpec</span><span class="o">=</span><span class="s2">&quot;-0d&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">ns_name</span><span class="p">))</span>
<span class="n">aquery</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">AnnotationQuery</span><span class="p">(</span><span class="n">scope_name</span><span class="p">,</span> <span class="n">metric_name</span><span class="p">,</span> <span class="s2">&quot;generated&quot;</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">tags</span><span class="p">,</span> <span class="n">stTimeSpec</span><span class="o">=</span><span class="s2">&quot;-1d&quot;</span><span class="p">,</span> <span class="n">enTimeSpec</span><span class="o">=</span><span class="s2">&quot;-0d&quot;</span><span class="p">))</span>
<span class="n">content</span> <span class="o">=</span> <span class="n">lxml</span><span class="o">.</span><span class="n">etree</span><span class="o">.</span><span class="n">tostring</span><span class="p">(</span><span class="n">DASHBOARD</span><span class="p">(</span>
    <span class="n">CHART</span><span class="p">(</span>
        <span class="n">TITLE</span><span class="p">(</span><span class="s2">&quot;hdara.test&quot;</span><span class="p">),</span>
        <span class="n">METRIC</span><span class="p">(</span><span class="n">mquery</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hdara.test.metric&quot;</span><span class="p">),</span>
        <span class="n">FLAGS</span><span class="p">(</span><span class="n">aquery</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;hdara.test.annotation&quot;</span><span class="p">),</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Chart&quot;</span>
        <span class="p">)</span>
<span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
<span class="n">dashbobj</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
</pre></div>
</div>
</div>
<div class="section" id="update-or-create-dashboard">
<h3>Update or Create dashboard<a class="headerlink" href="#update-or-create-dashboard" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Looking up existing dashboard with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dashboard_name</span><span class="p">)</span>
<span class="n">dashbobj</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">dashboards</span><span class="o">.</span><span class="n">get_user_dashboard</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">dashboard_name</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">dashbobj</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating new dashboard with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dashboard_name</span><span class="p">)</span>
    <span class="n">dashbobj</span> <span class="o">=</span> <span class="n">Dashboard</span><span class="p">(</span><span class="n">dashboard_name</span><span class="p">,</span> <span class="n">content</span><span class="p">,</span> <span class="n">shared</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;A new dashboard&quot;</span><span class="p">)</span>
    <span class="n">dashbobj</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">dashboards</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">dashbobj</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Updating dashboard with name: </span><span class="si">%s</span><span class="s2"> id </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">dashboard_name</span><span class="p">,</span> <span class="n">dashbobj</span><span class="o">.</span><span class="n">argus_id</span><span class="p">)</span>
    <span class="n">dashbobj</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
    <span class="n">argus</span><span class="o">.</span><span class="n">dashboards</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dashbobj</span><span class="o">.</span><span class="n">argus_id</span><span class="p">,</span> <span class="n">dashbobj</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Dashboard url: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">endpoint</span><span class="p">),</span> <span class="s2">&quot;argus/#/dashboards&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">dashbobj</span><span class="o">.</span><span class="n">argus_id</span><span class="p">))</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-ws&quot;</span><span class="p">,</span> <span class="s2">&quot;-ui&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="look-for-an-existing-alert-and-delete-it-so-that-we-can-recreate-it">
<h3>Look for an existing alert and delete it so that we can recreate it<a class="headerlink" href="#look-for-an-existing-alert-and-delete-it-so-that-we-can-recreate-it" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Looking up existing alerts with name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alert_name</span><span class="p">)</span>
<span class="n">alerts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(((</span><span class="n">alert</span><span class="o">.</span><span class="n">ownerName</span><span class="p">,</span> <span class="n">alert</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="n">alert</span><span class="p">)</span> <span class="k">for</span> <span class="n">alert</span> <span class="ow">in</span> <span class="n">argus</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">alertobj</span> <span class="o">=</span> <span class="n">alerts</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="n">user</span><span class="p">,</span> <span class="n">alert_name</span><span class="p">))</span>
<span class="k">if</span> <span class="n">alertobj</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Deleting existing alert with name: </span><span class="si">%s</span><span class="s2"> id: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alert_name</span><span class="p">,</span> <span class="n">alertobj</span><span class="o">.</span><span class="n">argus_id</span><span class="p">)</span>
    <span class="n">argus</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">alertobj</span><span class="o">.</span><span class="n">argus_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="finally-create-alert-with-a-trigger-and-a-notification">
<h3>Finally, create alert with a trigger and a notification<a class="headerlink" href="#finally-create-alert-with-a-trigger-and-a-notification" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Creating new alert with alert name: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">alert_name</span><span class="p">)</span>
<span class="n">alertobj</span> <span class="o">=</span> <span class="n">argus</span><span class="o">.</span><span class="n">alerts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Alert</span><span class="p">(</span><span class="n">alert_name</span><span class="p">,</span> <span class="n">mquery</span><span class="p">,</span> <span class="s2">&quot;* */1 * * *&quot;</span><span class="p">,</span>
                                  <span class="n">trigger</span><span class="o">=</span><span class="n">Trigger</span><span class="p">(</span><span class="s2">&quot;hdara.test.trigger&quot;</span><span class="p">,</span> <span class="n">Trigger</span><span class="o">.</span><span class="n">GREATER_THAN</span><span class="p">,</span> <span class="mi">100000</span><span class="p">,</span> <span class="mi">600000</span><span class="p">),</span>
                                  <span class="n">notification</span><span class="o">=</span><span class="n">Notification</span><span class="p">(</span><span class="s2">&quot;hdara.test.notification&quot;</span><span class="p">,</span> <span class="n">Notification</span><span class="o">.</span><span class="n">EMAIL</span><span class="p">,</span> <span class="n">subscriptions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;hdara@salesforce.com&quot;</span><span class="p">]),</span>
                                  <span class="n">shared</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">argusclient &#8211; A minimal client library for Argus webservice</a><ul>
<li><a class="reference internal" href="#a-quick-primer-to-using-argusclient">A quick primer to using argusclient</a><ul>
<li><a class="reference internal" href="#some-package-imports-and-initializations-that-we-use-later">Some package imports and initializations that we use later</a></li>
<li><a class="reference internal" href="#login-to-the-service-and-establish-session">Login to the service and establish session</a></li>
<li><a class="reference internal" href="#check-if-a-namespace-exists-and-create-one-if-missing">Check if a namespace exists and create one if missing</a></li>
<li><a class="reference internal" href="#generate-some-random-metrics-against-hdara-ns-hdara-test-and-mark-the-start-and-end-with-annotations">Generate some random metrics against hdara-ns:hdara:test and mark the start and end with annotations.</a></li>
<li><a class="reference internal" href="#send-metrics-and-annotations-to-argus">Send metrics and annotations to Argus</a></li>
<li><a class="reference internal" href="#generate-dashboard-content">Generate dashboard content</a></li>
<li><a class="reference internal" href="#update-or-create-dashboard">Update or Create dashboard</a></li>
<li><a class="reference internal" href="#look-for-an-existing-alert-and-delete-it-so-that-we-can-recreate-it">Look for an existing alert and delete it so that we can recreate it</a></li>
<li><a class="reference internal" href="#finally-create-alert-with-a-trigger-and-a-notification">Finally, create alert with a trigger and a notification</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="argusclient.html" title="previous chapter">argusclient Package</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/README.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Hari Krishna Dara.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/README.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>